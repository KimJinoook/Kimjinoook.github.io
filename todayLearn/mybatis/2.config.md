# 마이바티스 설정 및 사용 예
## 마이바티스 설정
- mybatis-config.xml
- 설정파일은 getConnection 메서드의 데이터베이스 연결정보를 대체한다
  - 트랜잭션 관리자
    - JDBC 코드를 대체하기 때문에 type은 JDBC로 지정
  - 데이터베이스 설정
    - 데이터베이스 연결 정보를 설정
  - 매퍼 정보 설정
    - sql을 선언해둔 xml이나 인터페이스 형태의 매퍼 위치를 지정
    - xml의 위치는 클래스패스를 기준으로 지정   

```html
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-config.dtd">

<configuration>
  <typeAliases>
    <typeAlias type="ldg.mybatis.model.Comment" alias="Comment" />
  </typeAliases>
  
  <environments default="development">
    <environment id="development">
      <transactionManager type="JDBC" />
      <dataSource type="POOLED">
        <property name="driver" value="oracle.jdbc.driver.OracleDriver" />
        <property name="url" value="jdbc:oracle:thin:@user-00:1521:orcl" />
        <property name="username" value="herb" />
        <property name="password" value="herb123" />
      </dataSource>
    </environment>
  </environments>
  <mappers>
    <mapper resource="ldg/mybatis/repository/mapper/CommentMapper.xml" />
  </mappers>
</configuration>

```

***

## 마이바티스 객체 생성
- 설정파일을 로드해 마이바티스 객체 생성
- 마이바티스 객체는 SQL선언을 제외하고 JDBC 코드가 처리하던 대부분을 내부적으로 처리해준다   

```java
public class CommentSessionRepository {
  private SqlSessionFactory getSqlSessionFactory() {
    String resource = "mybatis-config.xml";
    InputStream inputStream;
    try {
      inputStream = Resources.getResourceAsStream(resource);
    } catch (IOException e) {
      throw new IllegalArgumentException(e);
    }
    return new SqlSessionFactoryBuilder().build(inputStream);
  }
}
```
- 마이바티스 사용 시 getSqlSessionFactory() 메서드를 사용해 객체를 생성한 후 api 호출 가능
- inputStream = Resources.getResourceAsStream(resource);
  - 설정 파일 위치를 지정해 마이바티스 설정 정보에 대한 객체를 생성한다
  - 설정파일은 클래스패스를 기준으로 파일명을 적어주면 된다
- new SqlSessionFactoryBuilder().build(inputStream);
  - SqlSessionFactory 객체 생성
  - 전반적인 정보를 갖는 특성으로 인해 애플리케이션 내에서 한개만 생성되어야 한다   

***

## 파라미터 표기법
