# 서브쿼리 (Sub query)
## 1. Sub query란
- 쿼리 안에 또 다른 쿼리가 담겨있는 것
- sql문을 작성할 때 질문이 여러가지가 한번에 나오는 경우
  - a보다 급여를 많이 받는 사람 조회
    - a의 급여 조회
    - 더 많이 받는 사람 한번 더 조회
    - 2번의 sql 작성
    - 이런 문제점 보안 : sub query
- 문법
  - where 조건연산자 (select ~ from where)
  - 괄호 안에 서브쿼리 작성   
- 주의사항
  - where절의 연산자 오른쪽에 위치
  - 괄호로 묶어야 함
  - 특별한 경우를 제외하고는 서브쿼리 절에 order by절이 올 수 없다
- 종류
  - 단일 행 서브쿼리 : 서브쿼리의 결과가 1개의 행
  - 다중 행 서브쿼리 : 서브쿼리의 결과가 2건 이상
  - 다중 컬럼 서브쿼리 : 서브쿼리의 결과가 여러 컬럼인 경우
  - 상호연관 서브쿼리 : 
    - 메인 쿼리의 값을 서브쿼리에 주고 서브쿼리 수행
    - 서브쿼리 결과를 다시 메인쿼리로 반환해서 수행

```sql
--기존
select sal from emp
where ename = 'SCOTT'; --급여 3000

select * from emp
where sal > 3000; -- 3000보다 높은 급여 조회

--서브쿼리 이용
select * from emp
where sal > (select sal from emp where ename = 'SCOTT');

     EMPNO ENAME      JOB              MGR HIREDATE                 SAL       COMM     DEPTNO
---------- ---------- --------- ---------- ----------------- ---------- ---------- ----------
      7839 KING       PRESIDENT            81/11/17 00:00:00       5000                    10
```

## 2. 단일 행 서브쿼리
- 서브쿼리의 결과가 1개의 행만 나오는 것
- 연산자
  - =,!=,>,>=,<,<=   

```sql
select * from student s join department d
on s.deptno1 = d.deptno
where deptno1 = (select deptno1 from student where name = '이윤나');

    STUDNO NAME       DEPTNO DNAME     PART BUILD                                   
---------- ---------- ----------------------------
      9411 서진수     101 컴퓨터공학과  100 정보관                                  
      9511 김신영     101 컴퓨터공학과  100 정보관                                  
      9611 일지매     101 컴퓨터공학과  100 정보관                                  
      9711 이윤나     101 컴퓨터공학과  100 정보관  
```
